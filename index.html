<!DOCTYPE html>
<html lang="fr">
<head>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Institut Coran - Version ComplÃ¨te</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ•Œ Institut de Coran</h1>
            <p>SystÃ¨me de gestion complet</p>
        </div>

        <div class="mobile-nav">
            <button class="nav-button active" onclick="switchToSection('dashboard', this)">
                <span>ğŸ“Š Tableau de bord</span>
            </button>
            <button class="nav-button" onclick="switchToSection('students', this)">
                <span>ğŸ‘¥ Ã‰lÃ¨ves</span>
            </button>
            <button class="nav-button" onclick="switchToSection('teachers', this)">
                <span>ğŸ‘¨â€ğŸ« Professeurs</span>
            </button>
            <button class="nav-button" onclick="switchToSection('products', this)">
                <span>ğŸ“¦ Produits</span>
            </button>
            <button class="nav-button" onclick="switchToSection('payments', this)">
                <span>ğŸ’° Paiements</span>
            </button>
            <button class="nav-button" onclick="switchToSection('accounting', this)">
                <span>ğŸ“Š ComptabilitÃ©</span>
            </button>
        </div>

        <!-- SECTION COMPTABILITÃ‰ -->
        <div id="accounting" class="section-content">
            <div class="form-section">
                <h3>ğŸ“Š ComptabilitÃ© mensuelle</h3>

                <div style="display: flex; gap: 10px; margin-bottom: 20px; align-items: center;">
                    <label><strong>Mois :</strong></label>
                    <select id="monthSelector" onchange="changeMonth()">
                        <option value="0">Janvier</option>
                        <option value="1">FÃ©vrier</option>
                        <option value="2">Mars</option>
                        <option value="3">Avril</option>
                        <option value="4">Mai</option>
                        <option value="5">Juin</option>
                        <option value="6">Juillet</option>
                        <option value="7">AoÃ»t</option>
                        <option value="8">Septembre</option>
                        <option value="9">Octobre</option>
                        <option value="10">Novembre</option>
                        <option value="11">DÃ©cembre</option>
                    </select>

                    <label><strong>AnnÃ©e :</strong></label>
                    <select id="yearSelector" onchange="changeMonth()">
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                        <option value="2026">2026</option>
                    </select>
                </div>

                <div class="financial-summary">
                    <h4 style="margin-bottom: 15px; color: #2c3e50;">ğŸ’° RÃ©sumÃ© du mois sÃ©lectionnÃ©</h4>
                    <div class="financial-grid">
                        <div class="financial-item">
                            <strong>ğŸ“ˆ EntrÃ©es totales</strong><br>
                            <span id="totalIncome" style="color: #28a745; font-weight: bold;">0â‚¬</span>
                        </div>
                        <div class="financial-item">
                            <strong>ğŸ“‰ Sorties totales</strong><br>
                            <span id="totalExpenses" style="color: #dc3545; font-weight: bold;">0â‚¬</span>
                        </div>
                        <div class="financial-item">
                            <strong>ğŸ‘¨â€ğŸ« Salaires profs</strong><br>
                            <span id="totalTeacherSalaries" style="color: #dc3545; font-weight: bold;">0â‚¬</span>
                        </div>
                        <div class="financial-item">
                            <strong>ğŸ’ BÃ©nÃ©fice net</strong><br>
                            <span id="netProfit" style="color: #007bff; font-weight: bold;">0â‚¬</span>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>â• Ajouter une sortie d'argent</h3>
                    <form id="expenseForm">
                        <div class="form-group">
                            <label>Description *</label>
                            <input type="text" id="expenseDescription" required placeholder="Ex: Loyer, Ã©lectricitÃ©, matÃ©riel...">
                        </div>

                        <div class="form-group">
                            <label>Montant (â‚¬) *</label>
                            <input type="number" id="expenseAmount" required min="0" step="0.01" placeholder="0.00">
                        </div>

                        <div class="form-group">
                            <label>Date</label>
                            <input type="date" id="expenseDate" required>
                        </div>

                        <button type="submit" class="btn">ğŸ’¸ Ajouter cette sortie</button>
                    </form>
                </div>

                <div class="form-section">
                    <h3>ğŸ“‰ Liste des sorties (<span id="expensesCount">0</span>)</h3>
                    <div id="expensesListContainer" class="simple-table">
                        <div class="empty-state">Aucune sortie enregistrÃ©e</div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>ğŸ’¾ Synchronisation temps rÃ©el</h3>
                    <div style="text-align: center; padding: 20px; background: #e8f5e8; border-radius: 10px;">
                        <p><strong>ğŸ”„ Statut :</strong> <span id="syncStatus" style="color: #28a745;">SynchronisÃ©</span></p>
                        <p><strong>ğŸ‘¥ Collaboration :</strong> Toutes vos modifications sont automatiquement partagÃ©es avec votre collÃ¨gue</p>
                        <button class="btn btn-success" onclick="forceSyncNow()" style="width: auto; margin: 10px;">ğŸ”„ Synchroniser maintenant</button>
                        <button class="btn btn-success" onclick="downloadMonthlyBackup()" style="width: auto; margin: 10px;">ğŸ“¥ TÃ©lÃ©charger sauvegarde du mois</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- TABLEAU DE BORD -->
        <div id="dashboard" class="section-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="totalStudents">0</h3>
                    <p>Ã‰lÃ¨ves inscrits</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalTeachers">0</h3>
                    <p>Professeurs</p>
                </div>
                <div class="stat-card">
                    <h3 id="monthlyRevenue">0â‚¬</h3>
                    <p>Revenus du mois</p>
                </div>
                <div class="stat-card">
                    <h3 id="pendingPayments">0â‚¬</h3>
                    <p>En attente</p>
                </div>
            </div>

            <div class="form-section">
                <h3>ğŸ“Š FonctionnalitÃ©s disponibles</h3>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li>âœ… Gestion des Ã©lÃ¨ves avec calcul prorata</li>
                    <li>âœ… SystÃ¨me de rÃ©ductions personnalisÃ©es</li>
                    <li>âœ… Frais d'inscription automatiques (nouveaux Ã©lÃ¨ves)</li>
                    <li>âœ… Gestion des professeurs</li>
                    <li>âœ… Vente de produits (livres, matÃ©riel...)</li>
                    <li>âœ… Suivi des paiements en temps rÃ©el</li>
                    <li>âœ… Sauvegarde automatique des donnÃ©es</li>
                </ul>
            </div>
        </div>

        <!-- SECTION ELEVES -->
        <div id="students" class="section-content">
            <div class="form-section">
                <h3>â• Ajouter un nouvel Ã©lÃ¨ve</h3>
                <form id="studentForm">
                    <div class="form-group">
                        <label>PrÃ©nom de l'Ã©lÃ¨ve *</label>
                        <input type="text" id="studentFirstName" required placeholder="Ex: Ahmed">
                    </div>

                    <div class="form-group">
                        <label>Nom de l'Ã©lÃ¨ve *</label>
                        <input type="text" id="studentLastName" required placeholder="Ex: Benali">
                    </div>

                    <div class="form-group">
                        <label>NumÃ©ro de tÃ©lÃ©phone</label>
                        <input type="tel" id="studentPhone" placeholder="Ex: +33 6 12 34 56 78">
                    </div>

                    <div class="form-group">
                        <label>Type de formule *</label>
                        <select id="studentFormula" required>
                            <option value="">-- SÃ©lectionnez une formule --</option>
                            <option value="groupe_2h">ğŸ‘¥ Cours en groupe - 2h par semaine (32â‚¬/mois)</option>
                            <option value="groupe_1h">ğŸ‘¥ Cours en groupe - 1h par semaine (16â‚¬/mois)</option>
                            <option value="duo">ğŸ‘« Cours en duo (7â‚¬ par heure et par Ã©lÃ¨ve)</option>
                            <option value="individuel">ğŸ‘¤ Cours individuel (10â‚¬ par heure)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Nombre d'heures par semaine</label>
                        <select id="studentHours">
                            <option value="0.5">30 minutes</option>
                            <option value="1">1 heure</option>
                            <option value="1.5">1h30</option>
                            <option value="2">2 heures</option>
                            <option value="3">3 heures</option>
                            <option value="4">4 heures</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>ğŸ’¸ RÃ©duction (en â‚¬)</label>
                        <input type="number" id="studentReduction" min="0" step="0.01" placeholder="0" value="0">
                        <div class="small-text">Montant Ã  dÃ©duire du prix mensuel</div>
                    </div>

                    <div class="form-group">
                        <label>ğŸ‘¤ Type d'inscription</label>
                        <select id="inscriptionType">
                            <option value="new">ğŸ†• Nouveau Ã©lÃ¨ve (+5â‚¬ frais d'inscription)</option>
                            <option value="renewal">ğŸ”„ Renouvellement (pas de frais)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Jours de cours dans la semaine *</label>
                        <div class="course-days-container">
                            <div class="small-text" style="margin-bottom: 15px;">Cliquez sur les jours de cours :</div>
                            <div class="course-days-grid">
                                <label class="day-checkbox" onclick="toggleDaySelection(this)">
                                    <input type="checkbox" value="1">
                                    Lundi
                                </label>
                                <label class="day-checkbox" onclick="toggleDaySelection(this)">
                                    <input type="checkbox" value="2">
                                    Mardi
                                </label>
                                <label class="day-checkbox" onclick="toggleDaySelection(this)">
                                    <input type="checkbox" value="3">
                                    Mercredi
                                </label>
                                <label class="day-checkbox" onclick="toggleDaySelection(this)">
                                    <input type="checkbox" value="4">
                                    Jeudi
                                </label>
                                <label class="day-checkbox" onclick="toggleDaySelection(this)">
                                    <input type="checkbox" value="5">
                                    Vendredi
                                </label>
                                <label class="day-checkbox" onclick="toggleDaySelection(this)">
                                    <input type="checkbox" value="6">
                                    Samedi
                                </label>
                                <label class="day-checkbox" onclick="toggleDaySelection(this)">
                                    <input type="checkbox" value="0">
                                    Dimanche
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Date d'inscription *</label>
                        <input type="date" id="registrationDate" required>
                    </div>

                    <div class="form-group">
                        <label>Professeur assignÃ©</label>
                        <select id="assignedTeacher">
                            <option value="">-- SÃ©lectionnez un professeur --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>ğŸ’° Prix mensuel final</label>
                        <input type="text" id="fullMonthlyPrice" readonly class="price-field">
                    </div>

                    <div class="form-group">
                        <label>ğŸ“… Prix au prorata (premier mois)</label>
                        <input type="text" id="prorataPrice" readonly class="prorata-field">
                    </div>

                    <div class="form-group">
                        <label>ğŸ“‹ DÃ©tail du calcul</label>
                        <input type="text" id="calculationDetails" readonly>
                    </div>

                    <button type="submit" class="btn">âœ… Ajouter cet Ã©lÃ¨ve</button>
                </form>
            </div>

            <div class="form-section">
                <h3>ğŸ“‹ Liste des Ã©lÃ¨ves (<span id="studentsCount">0</span>)</h3>
                <div id="studentsListContainer" class="simple-table">
                    <div class="empty-state">
                        Aucun Ã©lÃ¨ve inscrit pour le moment<br>
                        <small>Utilisez le formulaire ci-dessus pour ajouter votre premier Ã©lÃ¨ve</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION PROFESSEURS -->
        <div id="teachers" class="section-content">
            <div class="form-section">
                <h3>â• Ajouter un nouveau professeur</h3>
                <form id="teacherForm">
                    <div class="form-group">
                        <label>PrÃ©nom du professeur *</label>
                        <input type="text" id="teacherFirstName" required placeholder="Ex: Fatima">
                    </div>

                    <div class="form-group">
                        <label>Nom du professeur *</label>
                        <input type="text" id="teacherLastName" required placeholder="Ex: El-Mansouri">
                    </div>

                    <div class="form-group">
                        <label>SpÃ©cialitÃ© d'enseignement</label>
                        <select id="teacherSpecialty">
                            <option value="Coran et Tajwid">ğŸ“– Coran et Tajwid</option>
                            <option value="Coran">ğŸ“œ Coran uniquement</option>
                            <option value="Tajwid">ğŸµ Tajwid uniquement</option>
                            <option value="Arabe">ğŸ”¤ Langue arabe</option>
                            <option value="Islamique">ğŸ•Œ Sciences islamiques</option>
                        </select>
                    </div>

                    <button type="submit" class="btn">âœ… Ajouter ce professeur</button>
                </form>
            </div>

            <div class="form-section">
                <h3>ğŸ‘¨â€ğŸ« Liste des professeurs (<span id="teachersCount">0</span>)</h3>
                <div id="teachersListContainer" class="simple-table">
                    <div class="empty-state">
                        Aucun professeur ajoutÃ© pour le moment<br>
                        <small>Utilisez le formulaire ci-dessus pour ajouter votre premier professeur</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION PRODUITS -->
        <div id="products" class="section-content">
            <div class="form-section">
                <h3>â• Ajouter un nouveau produit</h3>
                <form id="productForm">
                    <div class="form-group">
                        <label>Nom du produit *</label>
                        <input type="text" id="productName" required placeholder="Ex: Livre de Tajwid">
                    </div>

                    <div class="form-group">
                        <label>Prix (en â‚¬) *</label>
                        <input type="number" id="productPrice" required min="0" step="0.01" placeholder="15.00">
                    </div>

                    <div class="form-group">
                        <label>Description</label>
                        <input type="text" id="productDescription" placeholder="Description optionnelle">
                    </div>

                    <button type="submit" class="btn">âœ… Ajouter ce produit</button>
                </form>
            </div>

            <div class="form-section">
                <h3>ğŸ›’ Vendre un produit Ã  un Ã©lÃ¨ve</h3>
                <form id="saleForm">
                    <div class="form-group">
                        <label>Ã‰lÃ¨ve *</label>
                        <select id="saleStudentSelect" required>
                            <option value="">-- SÃ©lectionnez un Ã©lÃ¨ve --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Produit *</label>
                        <select id="saleProductSelect" required>
                            <option value="">-- SÃ©lectionnez un produit --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>QuantitÃ©</label>
                        <input type="number" id="saleQuantity" min="1" value="1" required>
                    </div>

                    <div class="form-group">
                        <label>ğŸ’° Total</label>
                        <input type="text" id="saleTotal" readonly class="price-field">
                    </div>

                    <button type="submit" class="btn">ğŸ›’ Enregistrer la vente</button>
                </form>
            </div>

            <div class="form-section">
                <h3>ğŸ“¦ Liste des produits (<span id="productsCount">0</span>)</h3>
                <div id="productsListContainer" class="simple-table">
                    <div class="empty-state">
                        Aucun produit ajoutÃ©<br>
                        <small>Ajoutez vos premiers produits ci-dessus</small>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h3>ğŸ›’ Historique des ventes (<span id="salesCount">0</span>)</h3>
                <div id="salesListContainer" class="simple-table">
                    <div class="empty-state">
                        Aucune vente enregistrÃ©e<br>
                        <small>Les ventes apparaÃ®tront ici</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION PAIEMENTS -->
        <div id="payments" class="section-content">
            <div class="form-section">
                <h3>ğŸ’° Suivi des paiements - <span id="currentMonthDisplay"></span></h3>

                <div class="financial-summary">
                    <h4 style="margin-bottom: 15px; color: #2c3e50;">ğŸ“Š RÃ©sumÃ© financier du mois</h4>
                    <div class="financial-grid">
                        <div class="financial-item">
                            <strong>Total attendu</strong><br>
                            <span id="totalExpectedAmount" style="color: #28a745; font-weight: bold;">0â‚¬</span>
                        </div>
                        <div class="financial-item">
                            <strong>Total reÃ§u</strong><br>
                            <span id="totalReceivedAmount" style="color: #28a745; font-weight: bold;">0â‚¬</span>
                        </div>
                        <div class="financial-item">
                            <strong>En attente</strong><br>
                            <span id="totalPendingAmount" style="color: #dc3545; font-weight: bold;">0â‚¬</span>
                        </div>
                        <div class="financial-item">
                            <strong>Frais d'inscription</strong><br>
                            <span id="totalInscriptionAmount" style="color: #28a745; font-weight: bold;">0â‚¬</span>
                        </div>
                    </div>
                </div>

                <div id="paymentsListContainer" class="simple-table">
                    <div class="empty-state">
                        Aucun paiement Ã  afficher<br>
                        <small>Les paiements apparaÃ®tront quand vous ajouterez des Ã©lÃ¨ves</small>
                    </div>
                </div>
            </div>
        </div>

        <div class="status-bar">
            <h3>âœ… Application fonctionnelle</h3>
            <p>Toutes les fonctionnalitÃ©s sont opÃ©rationnelles</p>
        </div>
    </div>
<script src="script.js"></script>
</body>
</html>